<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartAktau ‚Äî –ê–Ω–∞–ª–∏—Ç–∏–∫–∞</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/animations.css">
    <style>
        .analytics-container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 2rem;
        }

        .analytics-header {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }

        .analytics-header h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .analytics-header p {
            color: #718096;
        }

        .nav-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .stats-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
        }

        .stat-card.total::before { background: #667eea; }
        .stat-card.new::before { background: #f59e0b; }
        .stat-card.processing::before { background: #3b82f6; }
        .stat-card.completed::before { background: #10b981; }

        .stat-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            color: #718096;
            font-size: 1rem;
        }

        .stat-change {
            font-size: 0.85rem;
            margin-top: 0.5rem;
        }

        .stat-change.positive {
            color: #10b981;
        }

        .stat-change.negative {
            color: #ef4444;
        }

        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .chart-card {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .chart-card h2 {
            font-size: 1.25rem;
            margin-bottom: 1.5rem;
            color: #2d3748;
        }

        .chart-container {
            position: relative;
            height: 300px;
        }

        .timeline-chart {
            grid-column: 1 / -1;
        }

        .timeline-chart .chart-container {
            height: 350px;
        }

        .insights-section {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }

        .insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }

        .insight-card {
            padding: 1.5rem;
            border-radius: 8px;
            border-left: 4px solid #667eea;
            background: #f8fafc;
        }

        .insight-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #2d3748;
        }

        .insight-description {
            color: #4a5568;
            font-size: 0.9rem;
            line-height: 1.6;
        }

        .filter-controls {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }

        .filter-group {
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .filter-group label {
            font-weight: 600;
            color: #2d3748;
        }

        .filter-group select {
            padding: 0.5rem 1rem;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            font-size: 0.9rem;
            cursor: pointer;
        }

        @media (max-width: 768px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }

            .stats-overview {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Toast Notifications Container -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay hidden">
        <div class="loading-content">
            <div class="spinner"></div>
            <div class="loading-text">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        </div>
    </div>

    <div class="analytics-container">
        <!-- Header -->
        <div class="analytics-header">
            <h1>üìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ SmartAktau</h1>
            <p>–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –≥–æ—Ä–æ–¥—Å–∫–∏—Ö –æ–±—Ä–∞—â–µ–Ω–∏–π</p>
            <div class="nav-buttons">
                <a href="index.html" class="btn btn-secondary">‚Üê –ì–ª–∞–≤–Ω–∞—è</a>
                <a href="admin.html" class="btn btn-secondary">üë®‚Äçüíº –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</a>
            </div>
        </div>

        <!-- Stats Overview -->
        <div class="stats-overview">
            <div class="stat-card total scroll-reveal">
                <div class="stat-icon">üìã</div>
                <div class="stat-value" id="totalCount">0</div>
                <div class="stat-label">–í—Å–µ–≥–æ –æ–±—Ä–∞—â–µ–Ω–∏–π</div>
                <div class="stat-change" id="totalChange"></div>
            </div>

            <div class="stat-card new scroll-reveal">
                <div class="stat-icon">üÜï</div>
                <div class="stat-value" id="newCount">0</div>
                <div class="stat-label">–ù–æ–≤—ã–µ</div>
                <div class="stat-change" id="newPercent"></div>
            </div>

            <div class="stat-card processing scroll-reveal">
                <div class="stat-icon">‚öôÔ∏è</div>
                <div class="stat-value" id="processingCount">0</div>
                <div class="stat-label">–í –æ–±—Ä–∞–±–æ—Ç–∫–µ</div>
                <div class="stat-change" id="processingPercent"></div>
            </div>

            <div class="stat-card completed scroll-reveal">
                <div class="stat-icon">‚úÖ</div>
                <div class="stat-value" id="completedCount">0</div>
                <div class="stat-label">–í—ã–ø–æ–ª–Ω–µ–Ω–æ</div>
                <div class="stat-change" id="completedPercent"></div>
            </div>
        </div>

        <!-- Filter Controls -->
        <div class="filter-controls">
            <div class="filter-group">
                <label>–ü–µ—Ä–∏–æ–¥:</label>
                <select id="periodFilter">
                    <option value="7">–ü–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π</option>
                    <option value="30" selected>–ü–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π</option>
                    <option value="90">–ü–æ—Å–ª–µ–¥–Ω–∏–µ 90 –¥–Ω–µ–π</option>
                    <option value="all">–í—Å—ë –≤—Ä–µ–º—è</option>
                </select>

                <button id="refreshBtn" class="btn btn-primary">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
            </div>
        </div>

        <!-- Charts Grid -->
        <div class="charts-grid">
            <!-- Category Chart -->
            <div class="chart-card scroll-reveal">
                <h2>üìå –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º</h2>
                <div class="chart-container">
                    <canvas id="categoryChart"></canvas>
                </div>
            </div>

            <!-- Status Chart -->
            <div class="chart-card scroll-reveal">
                <h2>üìä –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º</h2>
                <div class="chart-container">
                    <canvas id="statusChart"></canvas>
                </div>
            </div>

            <!-- Timeline Chart -->
            <div class="chart-card timeline-chart scroll-reveal">
                <h2>üìà –î–∏–Ω–∞–º–∏–∫–∞ –æ–±—Ä–∞—â–µ–Ω–∏–π</h2>
                <div class="chart-container">
                    <canvas id="timelineChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Insights -->
        <div class="insights-section scroll-reveal">
            <h2>üí° –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã</h2>
            <div class="insights-grid" id="insightsContainer">
                <!-- Will be populated dynamically -->
            </div>
        </div>
    </div>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

    <!-- Supabase JS Client -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <!-- Analytics Script -->
    <script type="module" src="js/animations.js"></script>
    <script type="module" src="js/analytics.js"></script>
</body>
</html>
